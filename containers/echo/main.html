<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8">
<title>echo</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
<style>
body{display: flex; justify-content: center; align-items: center; height: 100vh;}
.container {letter-spacing:1px; color: rgb(35, 35, 36); text-shadow:0; font-size:32px; font-family: 'Roboto', sans-serif;}
</style>
</head>
<body translate="no">
<div id="message" class="container"></div>
<div style="width:75%;"><canvas id="canvas"></canvas></div>
<script>
var config = {
    type: 'line',
    data: {
        labels: ["11:00:12","11:01:12","11:02:21","11:31:33"],
        datasets: [{
            label: 'Dataset with point data',
            backgroundColor: "rgba(220,0,0,0.5)",
            borderColor: "rgba(220,0,0,0.5)",
            fill: false,
            data: [2,5,1,4],
        }]
    },
    options: {
        title: {    text: 'Chart.js Time Scale' },
        scales: {
            xAxes: [{   type: 'time',   time: { parser: 'HH:mm:ss', tooltipFormat: 'll HH:mm:ss'   },  scaleLabel: {   display: true,  labelString: 'Date' }   }],
            yAxes: [{   scaleLabel: {   display: true,  labelString: 'value'    }   }]
        },
    }
};

window.onload = function() {
    var ctx = document.getElementById('canvas').getContext('2d');
    window.myLine = new Chart(ctx, config);
};

setInterval( () => {
    console.log("ping")
    var request = new XMLHttpRequest();
    var t0 = performance.now()
    request.open("GET", "/pong", true);
    request.onload = function() {
        var t1 = performance.now()
        console.log(this.response, this.status, t1 - t0)
        var now = Date.now()
        //config.data.labels.push(now);
        //config.data.datasets.forEach((dataset) => { dataset.data.push({ x: now, y: (t1 - t0),   }); });    
        //console.log("-", config.data.datasets[0].data, "-")
        document.getElementById("message").innerHTML = (t1 - t0)
        //window.myLine.update();
    };
    request.send();
}
, 3000);
</script>
</body>
</html>
